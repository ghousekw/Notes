. BIOS
. Boot loaders
. Linux Kernel
. Runlevels

BIOS:
-----
. Basic Input/Output System
. Special firmware
. It's operating system independent.
  . This is not unique to the Linux OS.
. Primary purpose is to find and execute the boot loader.
. Performs the POST
  . Power-On self Test
. Knows about bootable devices.
  . Hard drives
  . USB drives
  . DVD drives
  . etc.,
. The boot device search order can be changed.

Boot Loaders:
-------------
. LILO
  . Linux Loader
. GRUB
  . Grand Unified Bootloader
  . Replaced LILO
. Boot loaders start the operating system.
. Boot loaders can start the operating system with different options.

Initial RAM Disk:
-----------------
. initrd
  . initial RAM disk
. Temporary filesystem that is loaded from disk and stored in memory.
. Contains helpers and modules required to load the permanent OS file system.

The /boot Directory:
--------------------
. /boot
  . Contains the files required to boot Linux
  . initrd 
  . Kernel
  . boot loader configuration

$ls -F /boot

Kernel Ring Buffer:
-------------------
. Contains messages from the Linux Kernel
. dmesg
. /var/log/dmesg

Runlevels/Description:
----------------------
0     Shuts down the system.
1,S,s Single user mode. Used for maintenance.
2     Multi-user mode with graphical 
      interface.
3     Multi-user text mode(RedHat/CentOS)
4     Undefined
5     Multi-user mode with graphical 
      interface.
6     Reboot

Init:
-----
/etc/inittab:

id:3:initdefault:

. Being phased out by systemd.

Systemd:
--------
. Uses targets instead of runlevels.

# cd
/lib/systemd/system
# ls -l runlevel5.target
lrwxrwxrwx. 1 root root 16 Jul 07 2019
runlevel5.target -> graphical.target
#systemctl set-default graphical.target

Changing runlevels or targets:
------------------------------
. telinit RUNLEVEL
  . telinit 5
. systemctl isolate TARGET
  . systemctl isolate graphical.target

Rebooting:
----------
#telinit 6
#systemctl isolate reboot.target
#reboot

Shutdown [options] time [message]

#shutdown -r 15:30 "rebooting!"
#shutdown -r +5 "rebooting soon!"
#shutdown -r now

Poweroff:
---------
#telinit 0
#systemctl isolate poweroff.target
#poweroff

System Logging:
---------------
. The syslog standard
. Facilities and severities
. syslog servers
. Logging rules
. Where logs are stored
. How to generate your own log messages
. Rotating log files

The Syslog Standard:
--------------------
. Aids in the processing of messages.
. Allows logging to be centrally controlled.
. Uses facilities and severities to 
  categorize messages.

Number Keyword    Description
0      Kern       Kernel messages
1      user       user-level messages 
2      mail       mail system
3      daemon     System daemons
4      auth       security/authorization 
                  messages
5      syslog     messages generated by 
                  syslogd  
6      lpr        line printer subsystem
7      news       network news subsystem
8      uucp       UUCP subsystem
9      clock      daemon
10     authpriv   security/authorization 
                  messages
11     ftp        FTP daemon
12      -         NTP subsystem
13      -         log audit
14      -         log alert
15      cron      clock daemon
16      local0    local use 0 (local0)
16      local1    local use 0 (local1)
16      local2    local use 0 (local2)
16      local3    local use 0 (local3)
...
23      local7    local use 7 (local7)

Code    Severity    Keyword       Description
0       Emergency   emerg(panic)  System is 
                                  unusable
1       alert       alert         Action 
                                  must be taken immediately
2       Critical    crit          Critical 
                                  Conditions 
3       Error       err(error)    Error 
                                  Conditions 
4       Warning     warning(warn) Warning 
                                  Conditions 
5       Notice      notice        Normal but 
                                  significantcondition
6       Info        info        
                                  Informational messages   
7       Debug       Debug         
                                  Debug-level-messages

Syslog Servers:
---------------
. Process syslog messages based on rules.
. syslogd
. rsyslog
. syslog-ng

rsyslog:
--------
/etc/rsyslog.conf:

$IncludeConfig /etc/rsyslog.d/*.conf

Logging Rules:
--------------
. Selector field
  . FACILITY.SEVERITY
  . mail.*
  . mail
  . FACILITY.none
  . FACILITY_1.SEVERITY;FACILITY_2.SEVERITY;
. Action field
  . Determines how a message is processed.

Example Logging Rule:
---------------------
mail.* /var/log/mail.log

Caching vs Non-Caching:
-----------------------
. Caching is used if the path starts with a hypen.
  .mail.info  -/var/log/mail.info
. You may lose some messages during a system crash if you are using caching mode.
. Using caching mode can improve I/O performance.

Example Logging Rule:
---------------------
mail.info -/var/log/mail.info
mail.warn -/var/log/mail.warn
mail.err -/var/log/mail.err

auth,authpriv.*   /var/log/auth.log
*.*;auth.none,authpriv.none   /var/log/syslog
*.info;mail.none,authpriv.none;cron.none /var/log/messages

logger:
-------
logger [options] message

options:
--------
-p FACILITY.SEVERITY
-t TAG

$ logger -p mail.info -t mailtest "Test."
$sudo tail -l /var/log/mail.log
Apr  4 16:33:10 linuxsvr mailtest: Test.

logrotate:
----------
/etc/logrotate.conf:
include /etc/logrotate.d

Example logrotate.conf:
-----------------------
weekly
rotate 4
create
compressed
include /etc/logrotate.d
/var/log/debug
/var/log/messages
{
  rotate 4
  weekly
  missingok
  compress
  sharedscripts
  postrotrate
    reload rsyslog >/dev/null 2>&1 || true
}

Test the logrotate configuration:
---------------------------------
# logrotate -fv /etc/logrotate.conf
